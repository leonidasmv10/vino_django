{% extends 'base.html' %}
{% load static %}

{% block title %}Actualizar Vino - Vinoteca Premium{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">üç∑ Actualizar Vino</h2>

    <form method="POST" action="{% url 'update_wine' wine.id %}" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Nombre del Vino -->
        <div class="form-group mb-3">
            <label for="name">Nombre del Vino:</label>
            <input type="text" class="form-control" id="name" name="name" value="{{ wine.name }}" required>
        </div>

        <!-- Descripci√≥n -->
        <div class="form-group mb-3">
            <label for="description">Descripci√≥n:</label>
            <textarea class="form-control" id="description" name="description" rows="3"
                required>{{ wine.description }}</textarea>
        </div>

        <!-- Precio -->
        <div class="form-group mb-3">
            <label for="price">Precio (EU):</label>
            <input type="number" class="form-control" id="price" name="price" value="{{ wine.price }}" step="0.01"
                required>
        </div>

        <!-- Categor√≠a -->
        <div class="form-group mb-3">
            <label for="category">Categor√≠a:</label>
            <select class="form-control" id="category" name="category" required>
                {% for category in categories %}
                <option value="{{ category.id }}" {% if category.id == wine.category.id %}selected{% endif %}>
                    {{ category.name }}
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Atributos del Vino -->
        <div class="form-group mt-3">
            <label>Atributos:</label>
            <div class="row">
                <div class="col-md-6">
                    <label for="cuerpo">‚öîÔ∏è Cuerpo:</label>
                    <input type="number" class="form-control" id="cuerpo" name="cuerpo" min="1" max="10" value="{{ wine.body }}">
                </div>
                <div class="col-md-6">
                    <label for="aroma">üåø Aroma:</label>
                    <input type="number" class="form-control" id="aroma" name="aroma" min="1" max="10" value="{{ wine.aroma }}">
                </div>
                <div class="col-md-6">
                    <label for="sabor">üç∑ Sabor:</label>
                    <input type="number" class="form-control" id="sabor" name="sabor" min="1" max="10" value="{{ wine.taste }}">
                </div>
                <div class="col-md-6">
                    <label for="taninos">üçá Taninos:</label>
                    <input type="number" class="form-control" id="taninos" name="taninos" min="1" max="10" value="{{ wine.tannins }}">
                </div>
                <div class="col-md-6">
                    <label for="acidez">üçã Acidez:</label>
                    <input type="number" class="form-control" id="acidez" name="acidez" min="1" max="10" value="{{ wine.acidity }}">
                </div>
                <div class="col-md-6">
                    <label for="dulzura">üç≠ Dulzura:</label>
                    <input type="number" class="form-control" id="dulzura" name="dulzura" min="1" max="10" value="{{ wine.sweetness }}">
                </div>
                <div class="col-md-6">
                    <label for="vintage">üè∫ Vintage:</label>
                    <input type="number" class="form-control" id="vintage" name="vintage" min="1" max="10" value="{{ wine.aging }}">
                </div>
            </div>
        </div>

        <!-- Imagen del Vino -->
        <div class="form-group mb-3">
            <label for="image">Imagen del Vino:</label>
            <input type="file" class="form-control-file" id="image" name="image" accept="image/*">
            <small class="text-muted">Sube una imagen del vino en formato JPG, PNG o GIF.</small>
            {% if wine.image %}
            <div class="mt-3">
                <img src="{{ wine.image.url }}" alt="Imagen del vino" class="img-fluid" style="max-width: 200px;">
            </div>
            {% else %}
            <p class="text-muted">No hay imagen previa para este vino.</p>
            {% endif %}
        </div>

        <!-- Bot√≥n de Actualizar -->
        <button type="submit" class="btn btn-success mt-4">Actualizar Vino</button>
    </form>
    <br>

</div>

<script>
    function previewImage() {
        const file = document.getElementById("image").files[0];
        const preview = document.getElementById("imagePreview");

        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                preview.src = e.target.result;
                preview.classList.remove("d-none");
            };
            reader.readAsDataURL(file);
        } else {
            preview.src = "{{ wine.image.url }}";
        }
    }
</script>

{% endblock %}